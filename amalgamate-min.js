!function(a){"use strict";var b,c,d,e,f;b={replace:function(a,b){return escape(a[b])},deepReplace:function(a,b){for(var c=a,d=0,e=b.length;e>d;d++){if("object"!=typeof c)return"";c=c[b[d]]}return escape(c)},array:function(a,b){for(var d=a[b.array],e=d.length,f=new Array(e),g=0;e>g;g++)f[g]=c(b.template,d[g]);return Array.prototype.concat.apply([],f).join("")},object:function(a,b){return d(b.template,a[b.object])},ifSo:function(a,b){return a[b.name]?d(b.template,a):""},ifNot:function(a,b){return a[b.name]?"":d(b.template,a)}},e={replace:function(a){var c=a.split(".");return 1===c.length?{op:b.replace,data:a}:{op:b.deepReplace,data:c}},array:function(a,c){return{op:b.array,data:{array:a,template:c}}},object:function(a,c){return{op:b.object,data:{object:a,template:c}}},ifSo:function(a,c){return{op:b.ifSo,data:{name:a,template:c}}},ifNot:function(a,c){return{op:b.ifNot,data:{name:a,template:c}}}},f=function(){var a=function(a,b){for(var c=[],d=0,e=a.length;e>d;d++){var f=a[d];c.push("string"==typeof f?f:b[f])}return c.join("")},b=function(){var b=Array.prototype.slice.call(arguments,0);return function(c,d){var e=a(b,d),f=c.indexOf(e);return-1===f?[c,""]:[c.slice(0,f),c.slice(f)]}},c=function(){var b=Array.prototype.slice.call(arguments,0);return function(c,d){var e=a(b,d);return 0===c.indexOf(e)?["",c.slice(e.length)]:!1}},d=function(a){return function(b){return-1===a.indexOf(b.slice(0,1))?[b.slice(0,1),b.slice(1)]:!1}},g=function(a){var b=f(a,!0);return b.partial?[b.instructions,b.leftovers]:[b,""]},h=function(a,d){return{rule:[c("{{"+a),b("}}"),c("}}"),g,c("{{/",1,"}}")],parse:function(a){for(var b=[],c=0,e=a[3].length;e>c;c++)a[3][c]&&b.push(a[3][c]);return d(a[1],b)}}},i=[h("#",e.array),h("@",e.object),h("?",e.ifSo),h("^",e.ifNot),{rule:[c("{{"),d("#@?^/"),b("}}"),c("}}")],parse:function(a){return e.replace(a[1]+a[2])}},{rule:[b("{{")],parse:function(a){return a[0]}}];return function(a,b){for(var c=[],d=i.length,e=null;a.length&&a.length!=e;){e=a.length;a:for(var f=0;d>f;f++){for(var g=i[f],h=a,j=[],k=0,l=g.rule.length;l>k;k++){var m=g.rule[k](h,j);if(m===!1)continue a;j.push(m[0]),h=m[1]}c.push(g.parse(j)),a=h;break}}return b&&a.length?{partial:!0,instructions:c,leftovers:a}:c}}(),c=function(a,b){for(var c=a.length,d=new Array(a.length),e=0;c>e;e++){var f=a[e];d[e]="object"==typeof f?f.op(b,f.data):f}return d},d=function(a,b){return 1==a.length&&"string"==typeof a[0]?a[0]:c(a,b).join("")};var g={render:d,compile:f,_builders:e};a?a.exports=g:window.Amalgamate=g}("object"==typeof module?module:null);